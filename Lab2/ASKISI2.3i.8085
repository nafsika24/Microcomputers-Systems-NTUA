BEGIN:
	MVI A,FFH	;στην αρχή κάθε δοκιμής φροντίζω ώστε όλα τα leds να είναι σβηστά
	STA 3000H
	LDA 2000H  	; Διάβαζεται η πόρτα εισόδου των dip switches
	MOV H,A	;Αποθηκεύω την κατάσταση τους στον καταχωρητή H
	MVI C,00H	;Ορίζω μετρητή C=0
	MVI B,01H  	;B=1

START:
	INR C
	CPI 00H
	JZ BEGIN	;C=C+1
	RLC		;Περιστρέφω αριστερά ώστε CY = αριστερότερο ψηφίο(πρώτα MSB)
	JNC START	;Εάν το CY είναι 0 επανάληψη μέχρι CY = 1

MOV E,C		;E=C (αποθηκεύω τον αριθμό των περιστροφών)

MOV A,B		;A=000000012

ON_FIRST:
	RAR		;Περιστρέφω δεξιά ώστε το 1 να βρεθεί στο MSB
	MOV B,A	;B=A
	DCR C		;C = C-1 μειώνω τον μετρητή περιστροφών
	MOV A,C	;A=C
	CPI 00H	;Ελέγχω εάν το 1 βρίσκεται στην ίδια θέση με το 1ο αριστερότερο ON
	JZ FLASH	;Εάν ναι jump FLASH
	MOV A,B		
	JMP ON_FIRST	;Αλλιώς συνεχίζω τη μετακίνηση του 1 προς τα δεξιά

FLASH:			;Ανάβει το led του 1ου αριστερότερου ΟΝ dip switch
	MOV A,B
	CMA
	STA 3000H
	CMA
	MOV B,A
	MVI D,80H	;D<-100000002

REST:
	MOV A,E		
	CPI 01H	;Ελέγχω εάν έχουν γίνει C-1 περιστροφές
	JZ FLASH_REST	;Εάν ναι ανάβουν όλα τα leds αριστερά από το 1ο αριστερότερο ON
	MOV E,A
	MOV A,B	
	ADD D		;A=A+D
	MOV B,A	;Αποθηκεύω την τιμή του Α στο Β
	MOV A,D	;A=D
	RAR		;Περιστροφή του D προς τα δεξιά, δηλαδή μετακίνηση του άσσου προς τα δεξία μέχρι να φτάσει μία θέση πριν το 1ο αριστερότερο ON
	MOV D,A
	MOV A,B
	DCR E		;Μειώνω τον μετρητή
	JMP REST

FLASH_REST:
	MOV A,B		
	CMA		;Αντιστροφή του Α
	STA 3000H	;Ανάβουν όλα τα leds αριστερά από το 1ο αριστερότερο ON
	CMA
	MOV B,A
	JMP NEXT

NEXT:
	LDA 2000H	;Φορτώνω την τωρινή είσοδο
	CMP H		;Συγκρίνω την τιμή της εισόδου που αποθηκεύτηκε στην αρχή στον καταχωρητή Η με την τωρινή τιμή
	JNZ BEGIN	;Εάν η θέση των dip switches έχει αλλάξει jump BEGIN
	JMP NEXT	;Αλλιώς τα αντίστοιχα leds παραμένουν αναμένα
 
END